<h1>index#session</h1>
<p>Find me in app/views/subscriptions/index.html.erb</p>

<div class="card-synthesis">
  <p><strong>Subscriptions</strong> last month</p>
  <h2><%= user.last_month_spent %>€</h2>
  <div class="d-flex justify-content-center mr-3">
    <% image_tag("icons/#{ user.last_month_trend }.png", class: "card-subscription-trend") %>
    <% if user.last_month_trend == 'arrow_up' %>
      <div class="card-synthesis-trend-up">
        <p>increase by <span class="var-amount"><%= user.last_month_var.abs %></span></p>
      </div>
    <% else %>
      <div class="card-synthesis-trend-down">
        <p>decrease by <span class="var-amount"><%= user.last_month_var.abs %>€</span></p>
      </div>
    <% end %>
  </div>
</div>


<% @subscriptions.each do |subscription| %>

<div class="card-subscription">
  <div class="card-subscription-left">
    <div class="card-subscription-top-left">
      <div class="card-subscription-operator">
        <h3><%= subscription.operator.name %></h3>
      </div>
      <div class="card-subscription-frequency">
        <p><%= subscription.payment_frequency %></p>
      </div>
    </div>
    <div class="card-subscription-bottom-left">
      <div class="card-subscription-price">
        <h2><%= subscription.avg_fee  %></h2>
      </div>
      <!--  Unless it's a new sub, display trend icon - up, down, flat - depending on last transactions variation -->
      <% unless subscription.new_sub? %>
        <% image_tag("#{ subscription.trend }.png", class:"card-subscription-trend") %>
      <% end %>
    </div>
  </div>
  <div class="card-subscription-right">
    <% image_tag( subscription.operator.logo , class:"card-subscription-logo") %>
    <div class="card-subscription-date">
      <p><%=  hightlight( subscription.time_before_next_payment , /\d/, highlighter: '<strong>\1</strong>') %></p>
    </div>
  </div>
</div>

<% end %>
